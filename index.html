<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¨ÙˆØª ØªÙ„Ø¬Ø±Ø§Ù… - Ø®Ø¯Ù…Ø© Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <!-- Ø¥Ø¶Ø§ÙØ© JotForm AI -->
    <script src='https://cdn.jotfor.ms/agent/embedjs/019932f8eeb67de397162a0d8c2d541451fe/embed.js'></script>
    <style>
        body {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .message-bubble {
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .typing-indicator {
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }
        .service-content {
            max-height: 400px;
            overflow-y: auto;
        }
        .typing-dots {
            display: inline-flex;
            gap: 3px;
        }
        .typing-dot {
            width: 6px;
            height: 6px;
            background-color: #6b7280;
            border-radius: 50%;
            animation: typing-bounce 1.4s infinite ease-in-out;
        }
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        @keyframes typing-bounce {
            0%, 80%, 100% {
                transform: scale(0.8);
                opacity: 0.5;
            }
            40% {
                transform: scale(1);
                opacity: 1;
            }
        }
        /* Ø²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹ Ø§Ù„Ù…Ø­Ø³Ù† */
        .back-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 14px;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .back-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(102, 126, 234, 0.4);
        }
        .back-button:active {
            transform: translateY(0);
        }
        /* Ø²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹ Ø§Ù„Ø¹Ø§Ø¦Ù… */
        .floating-back-button {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
            border: none;
            padding: 14px 18px;
            border-radius: 50px;
            font-weight: 700;
            font-size: 14px;
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
            z-index: 1000;
        }
        .floating-back-button:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.6);
        }
        /* Ø¥Ø®ÙØ§Ø¡ ÙˆØ§Ø¬Ù‡Ø© JotForm Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© */
        .jf-agent-widget {
            display: none !important;
        }
        .jf-agent-button {
            display: none !important;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <!-- Header -->
    <div class="bg-blue-600 text-white p-4 shadow-lg">
        <div class="flex items-center justify-between max-w-md mx-auto">
            <div class="flex items-center space-x-3 space-x-reverse">
                <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center">
                    <span class="text-blue-600 text-xl">ğŸ¤–</span>
                </div>
                <div>
                    <h1 class="font-bold text-lg">Ø¨ÙˆØª Ø®Ø¯Ù…Ø© Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ±</h1>
                    <p class="text-blue-200 text-sm" id="connectionStatus">Ù…ØªØµÙ„ Ø§Ù„Ø¢Ù†</p>
                </div>
            </div>
            <div class="text-blue-200">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"/>
                </svg>
            </div>
        </div>
    </div>

    <!-- Service Content Container -->
    <div id="serviceContentContainer" class="max-w-md mx-auto bg-white hidden">
        <div class="p-4 border-b border-gray-200 flex items-center justify-between bg-gradient-to-r from-blue-50 to-purple-50">
            <button onclick="backToServices()" class="back-button">
                <span>â¬…</span>
                <span>Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø®Ø¯Ù…Ø§Øª</span>
            </button>
            <h3 id="serviceTitle" class="font-bold text-gray-800 text-lg"></h3>
        </div>
        <div id="serviceContent" class="service-content p-4">
            <!-- Service content will be displayed here -->
        </div>
    </div>

    <!-- Floating Back Button -->
    <div id="floatingBackButton" class="fixed bottom-6 left-6 z-50 hidden">
        <button onclick="backToServices()" class="floating-back-button">
            <span>â†¶</span>
            <span>Ø±Ø¬ÙˆØ¹</span>
        </button>
    </div>

    <!-- Chat Container -->
    <div id="chatContainer" class="max-w-md mx-auto bg-white shadow-xl min-h-screen flex flex-col">
        <!-- Messages Area -->
        <div id="messagesArea" class="flex-1 p-4 space-y-4 overflow-y-auto">
            <!-- Welcome Message -->
            <div class="message-bubble">
                <div class="bg-gray-100 rounded-lg p-3">
                    <p class="text-gray-800">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø¨ÙˆØª Ø®Ø¯Ù…Ø© Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ±! ğŸ‘‹</p>
                    <p class="text-gray-600 text-sm mt-1">Ø£Ù†Ø§ Ù‡Ù†Ø§ Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ Ù…ØªØ§Ø¨Ø¹Ø© Ø´Ø¤ÙˆÙ† Ø§Ù„Ø·Ù„Ø§Ø¨ ÙˆØ§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø¢Ø®Ø± Ø§Ù„Ù…Ø³ØªØ¬Ø¯Ø§Øª.</p>
                </div>
            </div>

            <div class="message-bubble">
                <div class="bg-blue-50 rounded-lg p-3">
                    <p class="text-blue-800 font-medium">Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©:</p>
                    <p class="text-blue-600 text-sm mt-1">Ø§Ø®ØªØ± Ø§Ù„Ø®Ø¯Ù…Ø© Ø§Ù„ØªÙŠ ØªØ±ÙŠØ¯Ù‡Ø§ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø£Ø¯Ù†Ø§Ù‡</p>
                </div>
            </div>
        </div>

        <!-- Loading Indicator -->
        <div id="loadingIndicator" class="flex justify-center p-4 hidden">
            <div class="typing-indicator bg-blue-500 text-white rounded-lg p-3">
                <p>ğŸ”„ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</p>
            </div>
        </div>

        <!-- Services Container -->
        <div id="servicesContainer" class="p-4">
            <div class="grid grid-cols-2 gap-3">
                <button onclick="selectService('schedule')" class="bg-purple-500 hover:bg-purple-600 text-white p-3 rounded-lg text-sm font-medium transition-colors active:scale-95">
                    ğŸ“… Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ
                </button>
                <button onclick="selectService('homework')" class="bg-red-500 hover:bg-red-600 text-white p-3 rounded-lg text-sm font-medium transition-colors active:scale-95">
                    ğŸ“ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª
                </button>
                <button onclick="selectService('ai')" class="bg-cyan-500 hover:bg-cyan-600 text-white p-3 rounded-lg text-sm font-medium transition-colors active:scale-95">
                    ğŸ¤– Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
                </button>
                <button onclick="selectService('broadcast')" class="bg-green-500 hover:bg-green-600 text-white p-3 rounded-lg text-sm font-medium transition-colors active:scale-95">
                    ğŸ“¢ Ø§Ù„Ø¨Ø±ÙˆÙƒØ§Ø³Øª
                </button>
                <button onclick="selectService('programs')" class="bg-orange-500 hover:bg-orange-600 text-white p-3 rounded-lg text-sm font-medium transition-colors active:scale-95">
                    ğŸ† Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬
                </button>
                <button onclick="selectService('files')" class="bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-lg text-sm font-medium transition-colors active:scale-95">
                    ğŸ“ Ø§Ù„Ù…Ù„ÙØ§Øª
                </button>
                <button onclick="selectService('exams')" class="bg-pink-500 hover:bg-pink-600 text-white p-3 rounded-lg text-sm font-medium transition-colors active:scale-95">
                    ğŸ“‹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª
                </button>
                <button onclick="selectService('contact')" class="bg-indigo-500 hover:bg-indigo-600 text-white p-3 rounded-lg text-sm font-medium transition-colors active:scale-95">
                    ğŸ“ ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§
                </button>
            </div>
        </div>

        <!-- Input Area -->
        <div class="border-t bg-gray-50 p-4">
            <div class="flex items-center space-x-2 space-x-reverse">
                <input 
                    type="text" 
                    id="messageInput" 
                    placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§..."
                    class="flex-1 border border-gray-300 rounded-full px-4 py-2 focus:outline-none focus:border-blue-500"
                    onkeypress="handleKeyPress(event)"
                >
                <button 
                    onclick="sendMessage()" 
                    class="bg-blue-500 hover:bg-blue-600 text-white rounded-full p-2 transition-colors"
                >
                    <svg class="w-5 h-5 transform rotate-180" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"/>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <script>
        let botData = null;
        const API_URL = '/api/data';
        let jotformAIReady = false;
        
        // Initialize Telegram Web App
        if (window.Telegram && Telegram.WebApp) {
            Telegram.WebApp.ready();
            Telegram.WebApp.expand();
        }

        // Ù†Ø¸Ø§Ù… Ù…Ø±Ø§Ù‚Ø¨Ø© JotForm AI
        function initializeJotformAI() {
            console.log('ğŸ” Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† JotForm AI...');
            
            const checkAI = setInterval(() => {
                if (window.JotformAgent) {
                    console.log('âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ JotformAgent');
                    jotformAIReady = true;
                    clearInterval(checkAI);
                    return;
                }
                
                const jotformObjects = Object.keys(window).filter(key => 
                    key.toLowerCase().includes('jotform') || 
                    key.toLowerCase().includes('agent')
                );
                
                if (jotformObjects.length > 0) {
                    console.log('âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ÙƒØ§Ø¦Ù†Ø§Øª JotForm:', jotformObjects);
                    jotformAIReady = true;
                    clearInterval(checkAI);
                    return;
                }
            }, 1000);

            setTimeout(() => {
                clearInterval(checkAI);
                if (!jotformAIReady) {
                    console.log('âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ JotForm AI');
                }
            }, 10000);
        }

        // Ø¨Ø¯Ø¡ Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', function() {
            initializeJotformAI();
            loadData();
        });

        // Load data from server
        async function loadData() {
            showLoading(true);
            updateStatus('Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…...');
            
            try {
                const response = await fetch(API_URL);
                if (!response.ok) {
                    throw new Error('ÙØ´Ù„ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
                }
                
                botData = await response.json();
                updateStatus('âœ… Ù…ØªØµÙ„ - Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ø¯Ø«Ø©');
                showLoading(false);
                
            } catch (error) {
                console.error('Error:', error);
                updateStatus('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„');
                showLoading(false);
            }
        }

        async function selectService(service) {
            const serviceNames = {
                'schedule': 'Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ',
                'homework': 'Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª Ø§Ù„Ù…Ù†Ø²Ù„ÙŠØ©', 
                'ai': 'Ø±Ø¨ÙˆØª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ',
                'broadcast': 'Ø§Ù„Ø¨Ø±ÙˆÙƒØ§Ø³Øª',
                'programs': 'Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬ ÙˆØ§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø§Øª',
                'files': 'Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø±Ø³Ù„Ø©',
                'exams': 'Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª',
                'contact': 'ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§'
            };

            addMessage(`Ø§Ø®ØªØ±Øª: ${serviceNames[service]}`, true);
            
            if (service === 'ai') {
                if (jotformAIReady) {
                    addMessage('ğŸ¤– **Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…**\n\nÙ…Ø±Ø­Ø¨Ø§Ù‹! Ø£Ù†Ø§ Ù…Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„Ø°ÙƒÙŠ Ø§Ù„Ù…Ø¯Ø¹ÙˆÙ… Ø¨Ù€ JotForm AI.\n\nÙŠÙ…ÙƒÙ†Ù†ÙŠ:\nâ€¢ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù„Ù‰ Ø£Ø³Ø¦Ù„ØªÙƒ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø¨Ø¯Ù‚Ø© Ø¹Ø§Ù„ÙŠØ©\nâ€¢ Ø´Ø±Ø­ Ø§Ù„Ù…ÙØ§Ù‡ÙŠÙ… Ø§Ù„ØµØ¹Ø¨Ø© Ø¨Ø´ÙƒÙ„ Ù…Ø¨Ø³Ø·\nâ€¢ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ Ø­Ù„ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª ÙˆØ§Ù„ØªÙ…Ø§Ø±ÙŠÙ†\nâ€¢ ØªÙ‚Ø¯ÙŠÙ… Ù†ØµØ§Ø¦Ø­ Ø¯Ø±Ø§Ø³ÙŠØ© Ù…Ø®ØµØµØ©\nâ€¢ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù„Ù‰ Ø§Ø³ØªÙØ³Ø§Ø±Ø§ØªÙƒ Ø§Ù„Ø¹Ø§Ù…Ø©\n\nÙ…Ø§ Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ Ø£Ù† ØªØ³Ø£Ù„ Ø¹Ù†Ù‡ØŸ', false);
                } else {
                    addMessage('ğŸ¤– **Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ**\n\nÙ…Ø±Ø­Ø¨Ø§Ù‹! Ø¬Ø§Ø±ÙŠ ØªÙ‡ÙŠØ¦Ø© Ù†Ø¸Ø§Ù… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ...\n\nÙŠÙ…ÙƒÙ†Ùƒ:\nâ€¢ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±\nâ€¢ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ø¨Ø¹Ø¯ Ù‚Ù„ÙŠÙ„\nâ€¢ Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„ØªÙƒ ÙˆØ³Ø£Ø­Ø§ÙˆÙ„ Ù…Ø¹Ø§Ù„Ø¬ØªÙ‡Ø§\n\nÙ…Ø§ Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ Ù…Ø³Ø§Ø¹Ø¯Ø© ÙÙŠÙ‡ØŸ', false);
                }
                return;
            }
            
            showLoading(true);
            
            try {
                const response = await fetch(API_URL);
                if (!response.ok) throw new Error('ÙØ´Ù„ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
                
                const data = await response.json();
                const serviceData = data.services[service];
                
                showLoading(false);
                
                if (serviceData && serviceData.sections && serviceData.sections.length > 0) {
                    displayServiceContent(serviceData);
                } else {
                    useDefaultServiceResponse(service);
                }
                
            } catch (error) {
                showLoading(false);
                useDefaultServiceResponse(service);
            }
        }

        function displayServiceContent(serviceData) {
            document.getElementById('chatContainer').classList.add('hidden');
            document.getElementById('serviceContentContainer').classList.remove('hidden');
            document.getElementById('floatingBackButton').classList.remove('hidden');
            
            document.getElementById('serviceTitle').textContent = serviceData.name;
            
            let contentHtml = '';
            
            serviceData.sections.forEach(section => {
                contentHtml += `
                    <div class="mb-6">
                        <h4 class="font-bold text-gray-800 text-lg mb-3 border-b pb-2">${section.name}</h4>
                `;
                
                if (section.description && section.description !== 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙ') {
                    contentHtml += `<p class="text-gray-600 mb-4">${section.description}</p>`;
                }
                
                if (section.content && section.content.length > 0) {
                    section.content.forEach(item => {
                        if (item.type === 'text') {
                            contentHtml += `
                                <div class="bg-gray-50 p-4 rounded-lg mb-3">
                                    <div class="flex items-start space-x-2 space-x-reverse">
                                        <span class="text-gray-500 mt-1">ğŸ“„</span>
                                        <div>
                                            ${item.title ? `<h5 class="font-semibold text-gray-800 mb-2">${item.title}</h5>` : ''}
                                            <p class="text-gray-700 whitespace-pre-line">${item.content}</p>
                                        </div>
                                    </div>
                                </div>
                            `;
                        } else if (item.type === 'file') {
                            contentHtml += `
                                <div class="bg-green-50 p-4 rounded-lg mb-3">
                                    <div class="flex items-start space-x-2 space-x-reverse">
                                        <span class="text-green-600 mt-1">ğŸ“</span>
                                        <div class="flex-1">
                                            <h5 class="font-semibold text-green-800 mb-1">${item.name}</h5>
                                            <p class="text-green-700 text-sm mb-2">${item.description || 'Ù…Ù„Ù Ù…Ø±ÙÙˆØ¹'}</p>
                                            ${item.fileUrl ? `
                                                <a href="${window.location.origin}${item.fileUrl}" 
                                                   target="_blank"
                                                   class="inline-block bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition-colors">
                                                    ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù
                                                </a>
                                            ` : ''}
                                        </div>
                                    </div>
                                </div>
                            `;
                        } else if (item.type === 'image') {
                            contentHtml += `
                                <div class="bg-yellow-50 p-4 rounded-lg mb-3">
                                    <div class="flex items-start space-x-2 space-x-reverse">
                                        <span class="text-yellow-600 mt-1">ğŸ–¼ï¸</span>
                                        <div class="flex-1">
                                            <h5 class="font-semibold text-yellow-800 mb-2">${item.title}</h5>
                                            ${item.fileUrl ? `
                                                <img src="${window.location.origin}${item.fileUrl}" 
                                                     alt="${item.description || 'ØµÙˆØ±Ø©'}"
                                                     class="w-full max-w-md rounded-lg mb-2 border">
                                            ` : ''}
                                            <p class="text-yellow-700 text-sm mb-2">${item.description || 'ØµÙˆØ±Ø© Ù…Ø±ÙÙˆØ¹Ø©'}</p>
                                            ${item.fileUrl ? `
                                                <a href="${window.location.origin}${item.fileUrl}" 
                                                   target="_blank"
                                                   class="inline-block bg-yellow-600 text-white px-3 py-1 rounded text-sm hover:bg-yellow-700 transition-colors">
                                                    ğŸ‘ï¸ Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±Ø©
                                                </a>
                                            ` : ''}
                                        </div>
                                    </div>
                                </div>
                            `;
                        } else if (item.type === 'link') {
                            contentHtml += `
                                <div class="bg-purple-50 p-4 rounded-lg mb-3">
                                    <div class="flex items-start space-x-2 space-x-reverse">
                                        <span class="text-purple-600 mt-1">ğŸ”—</span>
                                        <div class="flex-1">
                                            <h5 class="font-semibold text-purple-800 mb-1">${item.title}</h5>
                                            <p class="text-purple-700 text-sm mb-2">${item.description || 'Ø±Ø§Ø¨Ø· Ø®Ø§Ø±Ø¬ÙŠ'}</p>
                                            <a href="${item.url}" 
                                               target="_blank"
                                               class="inline-block bg-purple-600 text-white px-3 py-1 rounded text-sm hover:bg-purple-700 transition-colors">
                                                ğŸŒ Ø²ÙŠØ§Ø±Ø© Ø§Ù„Ø±Ø§Ø¨Ø·
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            `;
                        }
                    });
                } else {
                    contentHtml += `
                        <div class="text-center py-4 bg-gray-50 rounded-lg">
                            <p class="text-gray-500">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø­ØªÙˆÙ‰ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù…</p>
                        </div>
                    `;
                }
                
                contentHtml += `</div>`;
            });

            document.getElementById('serviceContent').innerHTML = contentHtml;
        }

        function backToServices() {
            document.getElementById('serviceContentContainer').classList.add('hidden');
            document.getElementById('floatingBackButton').classList.add('hidden');
            document.getElementById('chatContainer').classList.remove('hidden');
        }

        function useDefaultServiceResponse(service) {
            const defaultResponses = {
                'schedule': 'ğŸ“… **Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ**\n\nØ¥Ù„ÙŠÙƒ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ù„Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹:\n\nğŸ“š Ø§Ù„Ø£Ø­Ø¯: Ø±ÙŠØ§Ø¶ÙŠØ§ØªØŒ Ø¹Ø±Ø¨ÙŠØŒ Ø¹Ù„ÙˆÙ…\nğŸ“š Ø§Ù„Ø§Ø«Ù†ÙŠÙ†: Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØŒ ØªØ§Ø±ÙŠØ®ØŒ Ø±ÙŠØ§Ø¶Ø©\nğŸ“š Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡: Ø¹Ù„ÙˆÙ…ØŒ Ø¬ØºØ±Ø§ÙÙŠØ§ØŒ ÙÙ†ÙˆÙ†\nğŸ“š Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡: Ø±ÙŠØ§Ø¶ÙŠØ§ØªØŒ Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØŒ ØªØ±Ø¨ÙŠØ© Ø¥Ø³Ù„Ø§Ù…ÙŠØ©\nğŸ“š Ø§Ù„Ø®Ù…ÙŠØ³: Ø¹Ù„ÙˆÙ…ØŒ Ø¹Ø±Ø¨ÙŠØŒ Ø£Ù†Ø´Ø·Ø©',
                'homework': 'ğŸ“ **Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª Ø§Ù„Ù…Ù†Ø²Ù„ÙŠØ©**\n\nØ§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:\n\nğŸ“ Ø±ÙŠØ§Ø¶ÙŠØ§Øª: Ø­Ù„ Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ† Øµ 45-47\nğŸ“ Ø§Ù„Ø¹Ø±Ø¨ÙŠ: ÙƒØªØ§Ø¨Ø© Ù…ÙˆØ¶ÙˆØ¹ ØªØ¹Ø¨ÙŠØ±\nğŸ“ Ø§Ù„Ø¹Ù„ÙˆÙ…: Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„ÙØµÙ„ Ø§Ù„Ø«Ø§Ù„Ø«\nğŸ“ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ: Ø­ÙØ¸ Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©\n\nğŸ“… Ù…ÙˆØ¹Ø¯ Ø§Ù„ØªØ³Ù„ÙŠÙ…: ØºØ¯Ø§Ù‹',
                'broadcast': 'ğŸ“¢ **Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ÙˆØ§Ù„Ø¨Ø±ÙˆÙƒØ§Ø³Øª**\n\nØ¢Ø®Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ÙˆØ§Ù„Ø£Ø®Ø¨Ø§Ø±:\n\nğŸ”” ØªØ°ÙƒÙŠØ±: Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª ÙŠÙˆÙ… Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡\nğŸ”” Ø¥Ø¬Ø§Ø²Ø© Ù†ØµÙ Ø§Ù„Ø¹Ø§Ù… ØªØ¨Ø¯Ø£ 15 ÙØ¨Ø±Ø§ÙŠØ±\nğŸ”” Ø§Ø¬ØªÙ…Ø§Ø¹ Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ± ÙŠÙˆÙ… Ø§Ù„Ø®Ù…ÙŠØ³\nğŸ”” ØªÙ… ØªØ£Ø¬ÙŠÙ„ Ø±Ø­Ù„Ø© Ø§Ù„ØµÙ Ø§Ù„Ø³Ø§Ø¯Ø³\n\nğŸ“… Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: Ø§Ù„ÙŠÙˆÙ… 2:30 Ù…',
                'programs': 'ğŸ† **Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬ ÙˆØ§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø§Øª**\n\nØ§Ù„Ø¨Ø±Ø§Ù…Ø¬ ÙˆØ§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©:\n\nğŸ¯ Ù…Ø³Ø§Ø¨Ù‚Ø© Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ… - Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ù…ÙØªÙˆØ­\nğŸ¯ Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„Ù…ÙˆØ§Ù‡Ø¨ Ø§Ù„Ø·Ù„Ø§Ø¨ÙŠØ© - 20 ÙØ¨Ø±Ø§ÙŠØ±\nğŸ¯ Ù…Ø³Ø§Ø¨Ù‚Ø© Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª - Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©\nğŸ¯ Ù…Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ù„ÙˆÙ… Ø§Ù„Ø³Ù†ÙˆÙŠ - Ù…Ø§Ø±Ø³ 2024',
                'files': 'ğŸ“ **Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø±Ø³Ù„Ø©**\n\nØ§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© Ù„Ù„ØªØ­Ù…ÙŠÙ„:\n\nğŸ“„ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©.pdf\nğŸ“„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©.pdf\nğŸ“„ Ù†Ù…ÙˆØ°Ø¬ Ø·Ù„Ø¨ Ø¥Ø¬Ø§Ø²Ø©.pdf\nğŸ“„ Ø¯Ù„ÙŠÙ„ ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±.pdf\nğŸ“„ Ø§Ù„ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ 2024.pdf',
                'exams': 'ğŸ“‹ **Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª**\n\nØ¬Ø¯ÙˆÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©:\n\nğŸ“ Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª: Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡ 10 ÙØ¨Ø±Ø§ÙŠØ± - 8:00 Øµ\nğŸ“ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©: Ø§Ù„Ø®Ù…ÙŠØ³ 11 ÙØ¨Ø±Ø§ÙŠØ± - 8:00 Øµ\nğŸ“ Ø§Ù„Ø¹Ù„ÙˆÙ…: Ø§Ù„Ø£Ø­Ø¯ 14 ÙØ¨Ø±Ø§ÙŠØ± - 8:00 Øµ\nğŸ“ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ: Ø§Ù„Ø§Ø«Ù†ÙŠÙ† 15 ÙØ¨Ø±Ø§ÙŠØ± - 8:00 Øµ\n\nâ° Ù…Ø¯Ø© ÙƒÙ„ Ø§Ø®ØªØ¨Ø§Ø±: Ø³Ø§Ø¹ØªØ§Ù†',
                'contact': 'ğŸ“ **ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§**\n\nÙ…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„:\n\nğŸ“± Ø§Ù„Ù‡Ø§ØªÙ: 011-234-5678\nğŸ“§ Ø§Ù„Ø¨Ø±ÙŠØ¯: info@school.edu.sa\nğŸŒ Ø§Ù„Ù…ÙˆÙ‚Ø¹: www.school.edu.sa\nğŸ“ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: Ø´Ø§Ø±Ø¹ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ØŒ Ø§Ù„Ø±ÙŠØ§Ø¶\n\nğŸ• Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„:\nØ§Ù„Ø£Ø­Ø¯ - Ø§Ù„Ø®Ù…ÙŠØ³: 7:00 Øµ - 2:00 Ù…'
            };
            
            addMessage(defaultResponses[service] || 'Ø§Ù„Ø®Ø¯Ù…Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹', false);
        }

        // Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ JotForm AI
        async function getJotformAIResponse(userMessage) {
            if (!jotformAIReady) {
                return generateSmartResponse(userMessage);
            }
            
            try {
                let response;
                
                if (window.JotformAgent && window.JotformAgent.sendMessage) {
                    response = await window.JotformAgent.sendMessage(userMessage);
                }
                else if (window.JotformAgent && window.JotformAgent.chat) {
                    response = await window.JotformAgent.chat(userMessage);
                }
                else {
                    const aiObjects = Object.keys(window).filter(key => 
                        key.toLowerCase().includes('jotform') || 
                        key.toLowerCase().includes('agent')
                    );
                    
                    for (const objName of aiObjects) {
                        const obj = window[objName];
                        if (obj && typeof obj.sendMessage === 'function') {
                            response = await obj.sendMessage(userMessage);
                            break;
                        }
                        if (obj && typeof obj.chat === 'function') {
                            response = await obj.chat(userMessage);
                            break;
                        }
                    }
                }
                
                if (response) {
                    return response;
                } else {
                    throw new Error('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø±Ø¯');
                }
                
            } catch (error) {
                console.error('JotForm AI Error:', error);
                return generateSmartResponse(userMessage);
            }
        }

        // Ø±Ø¯ Ø°ÙƒÙŠ Ø§Ø­ØªÙŠØ§Ø·ÙŠ
        function generateSmartResponse(userMessage) {
            const message = userMessage.toLowerCase().trim();
            
            if (message.includes('Ø´ÙƒØ±') || message.includes('thank')) {
                return 'Ø§Ù„Ø¹ÙÙˆ! ğŸ˜Š Ø³Ø¹ÙŠØ¯ Ù„Ø£Ù†Ù†ÙŠ Ø§Ø³ØªØ·Ø¹Øª Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ. Ù‡Ù„ Ù‡Ù†Ø§Ùƒ Ø´ÙŠØ¡ Ø¢Ø®Ø± ØªØ±ÙŠØ¯ Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ù†Ù‡ØŸ';
            }
            
            if (message.includes('Ù…Ø±Ø­Ø¨') || message.includes('hello') || message.includes('hi') || message.includes('Ø§Ù„Ø³Ù„Ø§Ù…')) {
                return 'ÙˆØ¹Ù„ÙŠÙƒÙ… Ø§Ù„Ø³Ù„Ø§Ù… ÙˆØ±Ø­Ù…Ø© Ø§Ù„Ù„Ù‡ ÙˆØ¨Ø±ÙƒØ§ØªÙ‡! ğŸŒŸ\n\nÙ…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ! Ø£Ù†Ø§ Ù…Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„Ø°ÙƒÙŠ ÙÙŠ Ø¨ÙˆØª Ø§Ù„Ù…Ø¯Ø±Ø³Ø©. ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø§Ù„ÙŠÙˆÙ…ØŸ';
            }
            
            if (message.includes('Ù…Ø³Ø§Ø¹Ø¯Ø©') || message.includes('help') || message.includes('Ù…Ø³Ø§Ø¹Ø¯Ù‡')) {
                return `ğŸ¯ **ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒØŸ**

ğŸ¤– **Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ:**
â€¢ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù„Ù‰ Ø§Ø³ØªÙØ³Ø§Ø±Ø§ØªÙƒ Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠØ©
â€¢ ØªÙˆØ¬ÙŠÙ‡Ùƒ Ù„Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©
â€¢ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ Ø§Ù„Ù…ÙˆØ§Ø¶ÙŠØ¹ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©

ğŸ“š **Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©:**
â€¢ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ ğŸ“…
â€¢ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª Ø§Ù„Ù…Ù†Ø²Ù„ÙŠØ© ğŸ“
â€¢ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ğŸ“‹
â€¢ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ù‡Ù…Ø© ğŸ“
â€¢ Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬ ÙˆØ§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø§Øª ğŸ†

Ù…Ø§ Ù‡Ùˆ Ù†ÙˆØ¹ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„Ø°ÙŠ ØªØ¨Ø­Ø« Ø¹Ù†Ù‡ØŸ`;
            }
            
            return `ğŸ¤– **Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ**

Ø´ÙƒØ±Ø§Ù‹ Ø¹Ù„Ù‰ Ø³Ø¤Ø§Ù„Ùƒ! ğŸ”

Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£ÙØ¶Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø©ØŒ ÙŠÙ…ÙƒÙ†Ùƒ:

â€¢ **Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…ØªØ®ØµØµØ©** ÙÙŠ Ø§Ù„Ø£Ø¹Ù„Ù‰ Ù„Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø¤ÙƒØ¯Ø©
â€¢ **ØªÙˆØ¶ÙŠØ­ Ø³Ø¤Ø§Ù„Ùƒ Ø£ÙƒØ«Ø±** Ù„Ø£ØªÙ…ÙƒÙ† Ù…Ù† Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø¨Ø´ÙƒÙ„ Ø£ÙØ¶Ù„
â€¢ **Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ù† Ù…ÙˆØ¶ÙˆØ¹ Ù…Ø­Ø¯Ø¯** Ù…Ø«Ù„ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø­ØµØµ Ø£Ùˆ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª

Ù…Ø§ Ù‡Ùˆ Ø§Ø³ØªÙØ³Ø§Ø±Ùƒ Ø¨Ø§Ù„ØªØ­Ø¯ÙŠØ¯ØŸ`;
        }

        function showLoading(show) {
            document.getElementById('loadingIndicator').classList.toggle('hidden', !show);
        }

        function updateStatus(status) {
            document.getElementById('connectionStatus').textContent = status;
        }

        function addMessage(text, isUser) {
            const messagesArea = document.getElementById('messagesArea');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message-bubble';
            
            if (isUser) {
                messageDiv.innerHTML = `
                    <div class="flex justify-end">
                        <div class="bg-blue-500 text-white rounded-lg p-3 max-w-xs">
                            <p>${text}</p>
                        </div>
                    </div>
                `;
            } else {
                messageDiv.innerHTML = `
                    <div class="flex justify-start">
                        <div class="bg-gray-100 rounded-lg p-3 max-w-xs">
                            <p class="text-gray-800 whitespace-pre-line">${text}</p>
                        </div>
                    </div>
                `;
            }
            
            messagesArea.appendChild(messageDiv);
            messagesArea.scrollTop = messagesArea.scrollHeight;
        }

        function showTypingIndicator() {
            const messagesArea = document.getElementById('messagesArea');
            const typingDiv = document.createElement('div');
            typingDiv.id = 'typingIndicator';
            typingDiv.className = 'message-bubble';
            typingDiv.innerHTML = `
                <div class="flex justify-start">
                    <div class="bg-gray-100 rounded-lg p-3 max-w-xs">
                        <div class="flex items-center space-x-2 space-x-reverse">
                            <div class="typing-dots">
                                <div class="typing-dot"></div>
                                <div class="typing-dot"></div>
                                <div class="typing-dot"></div>
                            </div>
                            <span class="text-gray-500 text-sm">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...</span>
                        </div>
                    </div>
                </div>
            `;
            messagesArea.appendChild(typingDiv);
            messagesArea.scrollTop = messagesArea.scrollHeight;
        }

        function hideTypingIndicator() {
            const typingIndicator = document.getElementById('typingIndicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        async function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (message) {
                addMessage(message, true);
                input.value = '';
                
                showTypingIndicator();
                
                setTimeout(async () => {
                    try {
                        const aiResponse = await getJotformAIResponse(message);
                        hideTypingIndicator();
                        addMessage(aiResponse, false);
                    } catch (error) {
                        hideTypingIndicator();
                        addMessage('Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.', false);
                    }
                }, 1500);
            }
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }
    </script>
</body>
</html>
